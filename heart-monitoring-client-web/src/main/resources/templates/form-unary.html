<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>.:: Heart Monitoring ::.</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Pacifico&family=Quicksand:wght@400;600&display=swap"
          rel="stylesheet">
    <style>
        body {
            background-color: #fff8f9;
            font-family: 'Quicksand', sans-serif;
        }

        @keyframes fadeInUp {
            0% {
                opacity: 0;
                transform: translateY(20px);
            }
            100% {
                opacity: 1;
                transform: translateY(0);
            }

        }
        @keyframes heartbeat {
            0% { transform: scale(1); }
            14% { transform: scale(1.3); }
            28% { transform: scale(1); }
            42% { transform: scale(1.3); }
            70% { transform: scale(1); }
        }

        .heartbeat {
            animation: heartbeat 1.5s infinite;
            transform-origin: center;
        }

        @keyframes fadeInUp {
            0% { opacity: 0; transform: translateY(20px); }
            100% { opacity: 1; transform: translateY(0); }
        }
    </style>
</head>
<body>
<div class="container mt-5 p-4 shadow rounded" style="background-color: #ffffff; max-width: 600px;">
    <h1 class="mb-4 text-center" style="font-family: 'Pacifico', cursive;">Enter patient name</h1>

    <form id="greetForm" class="text-center">
        <div class="mb-3">
            <input type="text" name="name" class="form-control" placeholder="Patient name" required
                   style="max-width: 400px; margin: 0 auto;"/>
        </div>
        <button type="submit" class="btn btn-danger">Submit</button>
    </form>

    <!-- Response Section -->
    <div id="responseSection" class="mt-5 d-none text-center">
        <img src="/heart.png" alt="Beating Heart" class="img-fluid mb-4 heartbeat" style="max-width: 300px;">
        <h2 id="greetingMessage" class="fw-bold text-danger"
            style="font-family: 'Pacifico', cursive; font-size: 5.5rem; animation: fadeInUp 1s ease-in-out;">
        </h2>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

<script>
    document.getElementById('greetForm').addEventListener('submit', function (event) {
        event.preventDefault();
        const formData = new FormData(this);
        const name = formData.get('name');

        fetch('/greet', {
            method: 'POST',
            headers: {'Content-Type': 'application/json'},
            body: JSON.stringify({name: name})
        })
            .then(response => response.json()) // ðŸ‘ˆ parse JSON
            .then(data => {
                const bpm = data.heartbeat;
                const timestamp = data.timestamp;

                document.getElementById('greetingMessage').textContent = `${bpm} bpm`;
                document.getElementById('responseSection').classList.remove('d-none');

                const heartbeatSound = document.getElementById('heartbeatSound');
                if (heartbeatSound) heartbeatSound.play();
            })
            .catch(error => console.error('Error:', error));
    });
</script>

<!--<audio id="heartbeatSound" src="/heart-beat.wav" preload="auto" loop></audio>-->
</body>
</html>